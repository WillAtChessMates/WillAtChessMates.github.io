<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eight Queens</title>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>

    <link rel="stylesheet"
      href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css"
      integrity="sha384-q94+BZtLrkL1/ohfjR8c6L+A6qzNH9R2hBLwyoAfu3i/WCvQjzL2RQJ3uNHDISdU"
      crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
        crossorigin="anonymous"></script>

    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"
        integrity="sha384-8Vi8VHwn3vjQ9eUHUxex3JSN/NFqUg3QbPyX8kWyb93+8AC/pPWTzj+nHtbC5bxD"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="board1" style="width: 60%"></div>
    <input type="submit" value="Check">
</body>
<script>
function pieceTheme(piece) {
    return `https://chessmates.com.au/wp-content/uploads/${piece}.png`;
}

var board = null;
var game = new Chess();
var $status = $('#status');
var $fen = $('#fen');
var $pgn = $('#pgn');

function onDrop (source, target) {
  console.log(board.position());
    if(board.position()[target] === undefined){
        return;
    }
    var move = game.move({
        from: source,
        to: target,
        promotion: 'q' // NOTE: always promote to a queen for example simplicity
    });

}

// update the board position after the piece snap
// for castling, en passant, pawn promotion
function onSnapEnd () {
  board.position(game.fen())
}

var config = {
  draggable: true,
  position: 'start',
  pieceTheme : pieceTheme,
  onDrop : onDrop,
  position: {
    "a8" : "wQ",
    "a7" : "wQ",
    "a6" : "wQ",
    "a5" : "wQ",
    "a4" : "wQ",
    "a3" : "wQ",
    "a2" : "wQ",
    "a1" : "wQ",
  }
};

board = Chessboard('board1', config);
$(window).resize(board.resize);


//select button with value check jquery
$("input[value='Check']").click(function() {
  checkAnswer();
});

function checkAnswer() {
  let positions = Object.keys(board.position()).map(s => (s.substring(0,1).toLowerCase().charCodeAt(0) - 96).toString() + s.substring(1));
  for(let i = 0; i < positions.length; i++) {
    for(let j = 0; j < positions.length; j++) {
      if(i == j) {
        continue;
      }
      let occupiedSquare = positions[i];
      let other = positions[j];
      // ranks and files
      if(occupiedSquare.charAt(0) === other.charAt(0) ||
         occupiedSquare.charAt(1) === other.charAt(1)) {
          alert("Not quite right");
          return;
      }

      // diagonals
      let diff = Math.abs(occupiedSquare.charCodeAt(0) - other.charCodeAt(0)) - Math.abs(occupiedSquare.charCodeAt(1) - other.charCodeAt(1));
      if(diff === 0) {
        alert("Not quite right");
        return;
      }
    }
  }

  alert(`Well done! You got ${positions.length} Queens on the board.`);
}

</script>
</html>